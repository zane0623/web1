"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_comment-box_api_file-upload_ts-ui_packages_comment-box_api_preview_ts-ui_packages-2c5e84"],{42742:(e,t,r)=>{r.d(t,{fU:()=>p,jw:()=>c,zL:()=>l});var n=r(57572),i=r(96540);let l=[".svg",".gif",".jpg",".jpeg",".png",".mov",".mp4",".webm"],a=[...l,".pdf",".docx",".pptx",".xlsx",".odt",".fodt",".ods",".fods",".odp",".fodp",".odg",".fodg",".odf",".csv",".xls",".zip",".gz",".tgz",".patch",".txt",".log",".md",".json",".jsonc",".cpuprofile",".dmp"];async function o(e,t,r){let i=new FormData,{name:l,size:a,type:o}=e;return t&&i.append("repository_id",t),r&&(i.append("upload_container_type","project"),i.append("upload_container_id",r)),i.append("name",l),i.append("size",a.toString()),i.append("content_type",o),await (0,n.DI)("/upload/policies/assets",{body:i,method:"POST"})}async function s(e,t){let{upload_authenticity_token:r,upload_url:n,header:i,form:l,same_origin:a}=e,o=new FormData;for(let e in a&&o.append("authenticity_token",r),l)o.append(e,l[e]);return o.append("file",t),await fetch(n,{headers:{...i},method:"post",body:o})}async function u(e,t){let r="string"==typeof e.asset_upload_url?e.asset_upload_url:null,n="string"==typeof e.asset_upload_authenticity_token?e.asset_upload_authenticity_token:null;if(r&&n){let e=new FormData;return e.append("authenticity_token",n),await fetch(r,{method:"PUT",body:e,credentials:"same-origin",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}})}return t}async function d(e,t,r){let n=await o(e,t,r);if(!n.ok)throw Error("Upload failed");let i=await n.json(),l=await s(i,e);if(!l.ok)throw Error("Upload failed");let a=await u(i,l);if(!a.ok)throw Error("Upload failed");let{href:d}=await a.json();if("string"!=typeof d)throw Error("Upload failed");return{url:d,file:e}}function c(e){return e?a:l}function p(e,t){return(0,i.useCallback)(async r=>d(r,e,t),[e,t])}},79198:(e,t,r)=>{r.d(t,{y:()=>a});var n=r(57572),i=r(96540);async function l({text:e,issue:t,repository:r,project:i,subjectType:l}){let a=new FormData;a.append("text",e),a.append("issue",t),a.append("repository",r),a.append("project",i),l&&a.append("subject_type",l);let o=await (0,n.DI)("/preview",{body:a,method:"POST"});return o.ok?Promise.resolve(await o.text()):Promise.resolve("Markdown preview unavailable")}function a({subjectId:e,subjectType:t,subjectRepoId:r}){return(0,i.useCallback)(async n=>l({text:n,issue:e?.toString()??"",repository:r?.toString()??"",project:e?.toString()??"",subjectType:function(e){switch(e){case"issue":return"Issue";case"pull_request":return"PullRequest";case"project":return"Project";default:return}}(t)}),[e,t,r])}},49339:(e,t,r)=>{function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{J:()=>CopilotAuthTokenProvider});let AuthToken=class AuthToken{get authorizationHeaderValue(){return`GitHub-Bearer ${this.value}`}needsRefreshing(e){return this.isExpired||this.ssoChanged(e)}get isExpired(){let e=new Date(this.expiration);return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))<new Date(Date.now()+15e3)}ssoChanged(e){return!(this.ssoOrgIDs.every(t=>e.includes(t))&&e.every(e=>this.ssoOrgIDs.includes(e)))}static fromResult(e,t){return new AuthToken(e.token,e.expiration,t)}serialize(){return{value:this.value,expiration:this.expiration,ssoOrgIDs:this.ssoOrgIDs}}static deserialize(e){return new AuthToken(e.value,e.expiration,e.ssoOrgIDs)}constructor(e,t,r){n(this,"value",void 0),n(this,"expiration",void 0),n(this,"ssoOrgIDs",void 0),this.value=e,this.expiration=t,this.ssoOrgIDs=r}};var i=r(80688),l=r(57572);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let o="COPILOT_AUTH_TOKEN";let CopilotAuthTokenProvider=class CopilotAuthTokenProvider{async getAuthToken(){let e=this.getLocalStorageAuthToken();return e?this.validateAuthToken(e):this.fetchAuthToken()}setLocalStorageAuthToken(e){this.copilotLocalStorage.setItem(o,JSON.stringify(e.serialize()))}getLocalStorageAuthToken(){let e=this.copilotLocalStorage.getItem(o);return e?AuthToken.deserialize(JSON.parse(e)):null}async validateAuthToken(e){return e.needsRefreshing(this.ssoOrgIDs)?this.fetchAuthToken():e}fetchAuthToken(){return this.currentAuthTokenRequest||(this.currentAuthTokenRequest=this._fetchAuthToken()),this.currentAuthTokenRequest}async _fetchAuthToken(){let e=await (0,l.lS)("/github-copilot/chat/token",{method:"POST"});if(e.ok){let t=await e.json();this.currentAuthTokenRequest=null;let r=AuthToken.fromResult(t,this.ssoOrgIDs);return this.setLocalStorageAuthToken(r),r}throw this.currentAuthTokenRequest=null,Error("Failed to mint new auth token")}constructor(e){a(this,"ssoOrgIDs",void 0),a(this,"currentAuthTokenRequest",void 0),a(this,"copilotLocalStorage",void 0),this.ssoOrgIDs=e,this.currentAuthTokenRequest=null,this.copilotLocalStorage=(0,i.A)("localStorage",{throwQuotaErrorsOnSet:!1,ttl:864e5})}}},76797:(e,t,r)=>{r.d(t,{D:()=>n});function n(e){if("clipboard"in navigator)return navigator.clipboard.writeText(e);let t=document.body;if(!t)return Promise.reject(Error());let r=function(e){let t=document.createElement("pre");return t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.top="5px",t.textContent=e,t}(e);return t.appendChild(r),!function(e){if("clipboard"in navigator)return navigator.clipboard.writeText(e.textContent||"");let t=getSelection();if(null==t)return Promise.reject(Error());t.removeAllRanges();let r=document.createRange();r.selectNodeContents(e),t.addRange(r),document.execCommand("copy"),t.removeAllRanges(),Promise.resolve()}(r),t.removeChild(r),Promise.resolve()}},78880:(e,t,r)=>{r.d(t,{n:()=>eQ,v:()=>e$});var n=r(74848),i=r(55847),l=r(96540);let a=(0,l.createContext)({disabled:!1,condensed:!1,required:!1,formattingToolsRef:{current:null},uploadButtonProps:null,fileDraggedOver:!1,previewMode:!1});try{a.displayName||(a.displayName="MarkdownEditorContext")}catch{}let o=({children:e})=>(0,n.jsx)(n.Fragment,{children:e});o.displayName="MarkdownEditor.Actions";let s=(0,l.forwardRef)((e,t)=>{let{disabled:r}=(0,l.useContext)(a);return(0,n.jsx)(i.Q,{ref:t,disabled:r,...e})});s.displayName="MarkdownEditor.ActionButton";var u=r(38621),d=r(24021);let c={footer:"Footer-module__footer--ihBso",footerWrapper:"Footer-module__footerWrapper--cGLx2",footerButtonWrapper:"Footer-module__footerButtonWrapper--X7Tti",footerButton:"Footer-module__footerButton--JxULX",childrenStyling:"Footer-module__childrenStyling--ySU6Z"},p=({children:e})=>{let[t,r]=(0,d.H)(e,{footerButtons:h});return(0,n.jsxs)("footer",{className:c.footer,children:[(0,n.jsxs)("div",{className:c.footerWrapper,children:[t.footerButtons&&(0,n.jsx)("div",{className:c.footerButtonWrapper,children:t.footerButtons}),(0,n.jsx)(m,{})]}),(0,n.jsx)("div",{className:c.childrenStyling,children:r})]})},f=({children:e})=>(0,n.jsx)(p,{children:e});f.displayName="MarkdownEditor.Footer";let h=(0,l.forwardRef)((e,t)=>{let{disabled:r}=(0,l.useContext)(a);return(0,n.jsx)(i.Q,{ref:t,size:"small",disabled:r,...e})});h.displayName="MarkdownEditor.FooterButton";let m=(0,l.memo)(()=>{let{uploadButtonProps:e,fileDraggedOver:t}=(0,l.useContext)(a);return e?(0,n.jsx)(g,{fileDraggedOver:t,...e}):null});m.displayName="MarkdownEditor.DefaultFooterButtons";let g=(0,l.memo)(({fileDraggedOver:e,...t})=>{let{condensed:r,disabled:o,fileUploadProgress:s}=(0,l.useContext)(a),d=s?.[0],p=s?.[1],f=!!p,h=1===p?"Uploading your file...":`Uploading your files... (${d}/${p})`;return(0,n.jsx)(i.Q,{variant:"invisible",loadingAnnouncement:f?h:void 0,leadingVisual:u.PaperclipIcon,loading:f,size:"small",className:c.footerButton,onMouseDown:e=>{e.preventDefault()},disabled:o,...t,children:r?"Add files":e?"Drop to add files":"Paste, drop, or click to add files"})});g.displayName="MarkdownEditor.FileUploadButton";try{p.displayName||(p.displayName="CoreFooter")}catch{}var v=r(52464),b=r(75177),w=r(20053);let x=({children:e,disabled:t,required:r,visuallyHidden:i,sx:l,as:a="label",className:o,...s})=>(0,n.jsx)(v.A,{as:a,sx:{fontWeight:"bold",fontSize:1,display:"block",color:t?"fg.muted":"fg.default",cursor:t?"not-allowed":"pointer",alignSelf:"flex-start",...l},className:i?(0,w.$)("sr-only",o):o,...s,children:r?(0,n.jsxs)(b.A,{as:"span",sx:{display:"flex"},children:[(0,n.jsx)(b.A,{sx:{mr:1},children:e}),(0,n.jsx)("span",{children:"*"})]}):e});try{x.displayName||(x.displayName="InputLabel")}catch{}let y={inputLabel:"Label-module__inputLabel--NkHiQ"},k=({...e})=>{let{disabled:t,required:r}=(0,l.useContext)(a);return(0,n.jsx)(x,{as:"legend",disabled:t,required:r,className:y.inputLabel,...e})};k.displayName="MarkdownEditor.Label";let C=e=>(0,n.jsx)(k,{...e});var S=r(75632),j=r(83476),T=r(73218),_=r(59356),E=r(84100),N=r(80758),I=r(58748),L=r(45221),A=r(65481),M=r(30729);let D={flash:"ErrorMessage-module__flash--MopQ2"},R=(0,l.memo)(({message:e})=>(0,n.jsx)(A.A,{variant:"danger",full:!0,className:D.flash,children:e}));R.displayName="MarkdownEditor.ErrorMessage";let $=(0,l.forwardRef)(({forInputId:e},t)=>{(0,l.useEffect)(()=>{r.e("vendors-node_modules_github_markdown-toolbar-element_dist_index_js").then(r.bind(r,78143))},[]);let i=(0,l.useRef)(null),a=(0,l.useRef)(null),o=(0,l.useRef)(null),s=(0,l.useRef)(null),u=(0,l.useRef)(null),d=(0,l.useRef)(null),c=(0,l.useRef)(null),p=(0,l.useRef)(null),f=(0,l.useRef)(null),h=(0,l.useRef)(null),m=(0,l.useRef)(null);return(0,l.useImperativeHandle)(t,()=>({header:()=>i.current?.click(),bold:()=>a.current?.click(),italic:()=>o.current?.click(),quote:()=>s.current?.click(),code:()=>u.current?.click(),link:()=>d.current?.click(),unorderedList:()=>c.current?.click(),orderedList:()=>p.current?.click(),taskList:()=>f.current?.click(),mention:()=>h.current?.click(),reference:()=>m.current?.click()})),(0,n.jsxs)("markdown-toolbar",{for:e,style:{display:"none"},children:[(0,n.jsx)("md-header",{ref:i}),(0,n.jsx)("md-bold",{ref:a}),(0,n.jsx)("md-italic",{ref:o}),(0,n.jsx)("md-quote",{ref:s}),(0,n.jsx)("md-code",{ref:u}),(0,n.jsx)("md-link",{ref:d}),(0,n.jsx)("md-unordered-list",{ref:c}),(0,n.jsx)("md-ordered-list",{ref:p}),(0,n.jsx)("md-task-list",{ref:f}),(0,n.jsx)("md-mention",{ref:h}),(0,n.jsx)("md-ref",{ref:m})]})});$.displayName="MarkdownEditor.FormattingTools";let P={container:"MarkdownEditor-module__container--LVNU1",inputWrapper:"MarkdownEditor-module__inputWrapper--MtV0d",fieldSet:"MarkdownEditor-module__fieldSet--VAeuT",previewHeader:"MarkdownEditor-module__previewHeader--kOTcb",fullHeight:"MarkdownEditor-module__fullHeight--loH82",hidden:"MarkdownEditor-module__hidden--_X5vc",disabled:"MarkdownEditor-module__disabled--idNQD",previewWrapper:"MarkdownEditor-module__previewWrapper--UHhTL",header:"MarkdownEditor-module__header--i0pok",viewSwitchWrapper:"MarkdownEditor-module__viewSwitchWrapper--ezg8E",viewSwitchBorder:"MarkdownEditor-module__viewSwitchBorder--zeiDB",previewViewerWrapper:"MarkdownEditor-module__previewViewerWrapper--ZCTeH",flash:"MarkdownEditor-module__flash--bC3Co"};r(90204);var H=r(44358),B=r(70255);let O=e=>{let[t,r]=(0,l.useState)(null),[n,i]=(0,l.useState)(null),a=(0,l.useMemo)(()=>e.map(({trigger:e})=>e),[e]),o=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(!n){r(null);return}(async function(){for(let{trigger:t,suggestionsCalculator:i}of(o.current=n,r("loading"),e))if(n.trigger.triggerChar===t.triggerChar){r(await i(n.query));break}})()},[n,e]),{triggers:a,suggestions:t,setSuggestionEvent:i,onHideSuggestions:()=>{i(null),r(null)},active:!!n}};var W=r(12800),F=r(64515),U=r(51856);let z={textArea:"MarkdownInput-module__textArea--QjIwG",fullHeight:"MarkdownInput-module__fullHeight--GQ5pQ",monospace:"MarkdownInput-module__monospace--hhBf3",displayNone:"MarkdownInput-module__displayNone--PnY5h",isDraggedOver:"MarkdownInput-module__isDraggedOver--Ual6r"};var V=r(83876),K=r(5804),q=r(62456),Q=r(8338),G=r(92575);let X={identifierText:"use-mention-suggestions-module__identifierText--vdUed"},J={triggerChar:"@"},Y=e=>({value:e.identifier,render:t=>(0,n.jsxs)(Q.l.Item,{...t,children:[e.avatarUrl&&(0,n.jsx)(Q.l.LeadingVisual,{children:(0,n.jsx)(q.r,{size:16,src:e.avatarUrl})}),(0,n.jsx)("span",{className:X.identifierText,children:e.identifier})," ",(0,n.jsx)(Q.l.Description,{truncate:!0,children:e.description})]})}),Z=(e,t)=>{let r=Math.max((0,K.dt)(e,t.identifier),(0,K.dt)(e,t.description));return r===K.IP?r:r>0&&t.participant?K.M4:t.participant?r+K.Dx:r},ee=(e,t)=>e.participant&&!t.participant?-1:t.participant&&!e.participant?1:e.identifier.localeCompare(t.identifier),et=e=>({calculateSuggestions:(0,l.useMemo)(()=>(0,G.C)(e,Z,ee,Y),[e]),trigger:J});var er=r(44968);let en={suggestionTitle:"use-reference-suggestions-module__suggestionTitle--N45Y8"},ei={triggerChar:"#",multiWord:!0},el=e=>({value:e.id,render:t=>(0,n.jsxs)(Q.l.Item,{...t,children:[e.iconHtml&&(0,n.jsx)(Q.l.LeadingVisual,{children:(0,n.jsx)(er.yx,{unverifiedHTML:e.iconHtml})}),(0,n.jsx)("span",{className:en.suggestionTitle,children:(0,n.jsx)(er.yx,{unverifiedHTML:e.titleHtml})})," ",(0,n.jsxs)(Q.l.Description,{truncate:!0,children:["#",e.id]})]})}),ea=(e,t)=>(0,K.dt)(e,`${t.id} ${t.titleText}`),eo=(e,t)=>0,es=e=>({calculateSuggestions:(0,l.useMemo)(()=>{let t=(0,G.C)(e,ea,eo,el);return async e=>/^\d+\s/.test(e)?[]:t(e)},[e]),trigger:ei}),eu=[],ed=(0,l.forwardRef)(({value:e,onChange:t,onInput:r,disabled:i,placeholder:a,id:o,maxLength:s,onKeyDown:u,fullHeight:d,isDraggedOver:c,emojiSuggestions:p,emojiTone:f,mentionSuggestions:h,referenceSuggestions:m,labelledBy:g,minHeightLines:v,maxHeightLines:b,visible:x,monospace:y,pasteUrlsAsPlainText:k,className:C,...S},j)=>{let T=(0,l.useMemo)(()=>({tone:f}),[f]),{trigger:_,calculateSuggestions:E}=(0,V.x)(p??eu,T),{trigger:N,calculateSuggestions:I}=et(h??eu),{trigger:L,calculateSuggestions:A}=es(m??eu),{triggers:M,suggestions:D,setSuggestionEvent:R,onHideSuggestions:$}=O((0,l.useMemo)(()=>[{trigger:_,suggestionsCalculator:E},{trigger:N,suggestionsCalculator:I},{trigger:L,suggestionsCalculator:A}],[E,I,A,_,N,L])),P=(0,l.useRef)(null);(0,F.T)(j,P),(0,l.useEffect)(()=>{let e=P.current&&(0,H.B1)(P.current,{defaultPlainTextPaste:{urlLinks:k}});return e?.unsubscribe},[k]);let K=(0,W.S)({disabled:d||!x,maxHeightLines:b,minHeightLines:v,elementRef:P,value:e});return(0,l.useEffect)(()=>{P.current&&(P.current.value=e)}),(0,n.jsx)(B.a,{triggers:M,suggestions:D,onShowSuggestions:R,onHideSuggestions:$,firstOptionSelectionMode:"selected",style:{flex:"auto"},tabInsertsSuggestions:!0,children:(0,n.jsx)(U.Ay,{id:o,ref:P,placeholder:a,maxLength:s,onKeyDown:u,disabled:i,"aria-label":g?void 0:"Markdown value","aria-labelledby":g,onChange:t,onInput:r,value:e,className:(0,w.$)(C,z.textArea,!x&&z.displayNone,d&&z.fullHeight,y&&z.monospace,c&&z.isDraggedOver),rows:v,style:K,...S})})});ed.displayName="MarkdownInput";var ec=r(47584),ep=r(61871),ef=r(10871);let eh={SavedReplies:"SavedReplies-module__SavedReplies--uPmHj"};var em=r(87330);let eg={iconButton:"ToolbarButton-module__iconButton--fTMrr"},ev=(0,l.forwardRef)((e,t)=>{let{disabled:r,condensed:i}=(0,l.useContext)(a);return(0,n.jsx)(em.K,{ref:t,size:i?"small":"medium",variant:"invisible",disabled:r,onMouseDown:e=>e.preventDefault(),...e,className:eg.iconButton})});ev.displayName="MarkdownEditor.ToolbarButton";let eb=(0,l.createContext)(null),ew=()=>{let e=(0,l.useContext)(eb);(0,l.useImperativeHandle)(e?.ref,()=>({openMenu:()=>{r(!0)}}));let[t,r]=(0,l.useState)(!1);(0,l.useEffect)(()=>{a(""),t&&e?.onOpen()},[e,t]);let[i,a]=(0,l.useState)(""),o=e?.savedReplies.filter(({name:e})=>e.toLowerCase().includes(i.toLowerCase())).map((e,t)=>({text:e.name,description:e.content,descriptionVariant:"block",trailingVisual:t<9?`Ctrl + ${t+1}`:void 0,className:eh.SavedReplies})),s=t=>{r(!1);let n=e?.savedReplies.find(({name:e})=>e===t?.text);n&&e?.onSelect(n)};return o?(0,n.jsx)(ep.X,{renderAnchor:e=>(0,n.jsx)(ev,{...e,icon:u.ReplyIcon,"aria-label":"Saved replies","aria-labelledby":void 0}),open:t,onOpenChange:r,items:o,filterValue:i,onFilterChange:a,placeholderText:"Search saved replies",selected:void 0,onSelectedChange:e=>{s(Array.isArray(e)?e[0]:e)},overlayProps:{width:"small",maxHeight:"small",anchorSide:"outside-right",onKeyDown:e=>{let t=parseInt(e.key,10);o&&e.ctrlKey&&!Number.isNaN(t)&&t>=1&&t<=9&&(e.stopPropagation(),e.preventDefault(),s(o[t-1]))}},footer:(0,n.jsx)(ef.z,{size:"small",href:`${ec.fV.origin}/settings/replies`,block:!0,children:"Create new"})}):(0,n.jsx)(n.Fragment,{})};try{eb.displayName||(eb.displayName="SavedRepliesContext")}catch{}try{ew.displayName||(ew.displayName="SavedRepliesButton")}catch{}var ex=r(69676),ey=r(82678);let ek={divider:"Toolbar-module__divider--uW6mE",toolbar:"Toolbar-module__toolbar--CkIKP"},eC=()=>(0,n.jsx)("div",{className:ek.divider}),eS=(0,l.memo)(()=>{let{condensed:e,formattingToolsRef:t}=(0,l.useContext)(a);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(ev,{onClick:()=>t.current?.header(),icon:u.HeadingIcon,"aria-label":"Heading"}),(0,n.jsx)(ev,{onClick:()=>t.current?.bold(),icon:u.BoldIcon,"aria-label":"Bold"}),(0,n.jsx)(ev,{onClick:()=>t.current?.italic(),icon:u.ItalicIcon,"aria-label":"Italic"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(eC,{}),(0,n.jsx)(ev,{onClick:()=>t.current?.quote(),icon:u.QuoteIcon,"aria-label":"Quote"}),(0,n.jsx)(ev,{onClick:()=>t.current?.code(),icon:u.CodeIcon,"aria-label":"Code"}),(0,n.jsx)(ev,{onClick:()=>t.current?.link(),icon:u.LinkIcon,"aria-label":"Link"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(eC,{}),(0,n.jsx)(ev,{onClick:()=>t.current?.unorderedList(),icon:u.ListUnorderedIcon,"aria-label":"Unordered list"}),(0,n.jsx)(ev,{onClick:()=>t.current?.orderedList(),icon:u.ListOrderedIcon,"aria-label":"Numbered list"}),(0,n.jsx)(ev,{onClick:()=>t.current?.taskList(),icon:u.TasklistIcon,"aria-label":"Task list"})]}),!e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(eC,{}),(0,n.jsx)(ev,{onClick:()=>t.current?.mention(),icon:u.MentionIcon,"aria-label":"Mention"}),(0,n.jsx)(ev,{onClick:()=>t.current?.reference(),icon:u.CrossReferenceIcon,"aria-label":"Reference"})]}),(0,n.jsx)(ew,{})]})});eS.displayName="MarkdownEditor.DefaultToolbarButtons";let ej=({children:e})=>{let t=(0,l.useRef)(null);return(0,ey.G)({containerRef:t,focusInStrategy:"closest",bindKeys:ex.z0.ArrowHorizontal|ex.z0.HomeAndEnd,focusOutBehavior:"wrap"}),(0,n.jsx)("div",{ref:t,"aria-label":"Formatting tools",role:"toolbar",className:ek.toolbar,children:e})},eT=({children:e})=>(0,n.jsx)(ej,{children:e});eT.displayName="MarkdownEditor.Toolbar";try{eC.displayName||(eC.displayName="Divider")}catch{}try{ej.displayName||(ej.displayName="CoreToolbar")}catch{}var e_=r(42445);let eE=/^([^/]+)\/([^;]+)/,eN=e=>{if(e.startsWith("."))return t=>t.name.toLowerCase().endsWith(e.toLowerCase());{let t=eE.exec(e);if(null===t)return()=>!1;let[,r,n]=t;return e=>{let[,t,i]=eE.exec(e.type)??[];return r?.toLowerCase()===t?.toLowerCase()&&("*"===n||n?.toLowerCase()===i?.toLowerCase())}}};function eI(e){let t=(0,l.useMemo)(()=>e.acceptedFileTypes?.map(eN),[e.acceptedFileTypes]),r=(0,l.useCallback)(e=>t?.some(t=>t(e))??!0,[t]);return(0,l.useCallback)(function(t){if(0===t.length)return!1;if(e.multi){let n=[],i=[];for(let e of t)r(e)?n.push(e):i.push(e);e.onSelect(n,i)}else{let n=t[0];n&&r(n)?e.onSelect(n,void 0):e.onSelect(void 0,n)}return!0},[r,e.multi,e.onSelect])}let eL=e=>Array.from(e.dataTransfer.items).some(({kind:e})=>"file"===e);var eA=r(32020);let eM=e=>(0,eA.nf)(`Uploading "${e.name}"...`),eD=(e,t,r)=>t?e.type.startsWith("video/")?t:e.type.startsWith("image/")?(0,eA.TG)(r||{width:0,height:0,ppi:1},t,"Image"):(0,eA.iQ)(e.name,t):(0,eA.nf)(`Failed to upload "${e.name}"`),eR=()=>{},e$=({emitChange:e,value:t,inputRef:r,disabled:n,onUploadFile:i,acceptedFileTypes:a})=>{let[o,s]=(0,l.useState)(void 0),u=(0,l.useRef)(!1);(0,l.useEffect)(()=>{if(o){u.current=!1;let e=setTimeout(()=>u.current=!0,1e3);return()=>clearTimeout(e)}},[o]),(0,l.useEffect)(()=>{u.current&&s(void 0)},[t]);let d=(0,E.U)(e=>{let t=new Set(e.map(({name:e})=>{let t=e.split(".");return t.length>1?`.${t.at(-1)}`:""}).filter(e=>""!==e));t.size>0&&s(`File type${t.size>1?"s":""} not allowed: ${[...t].join(", ")}`)}),[c,p]=(0,l.useState)(void 0),f=(0,E.U)(()=>p(void 0)),h=(0,l.useCallback)(t=>{if(!r?.current)return;let n=function(e,t){if(0===t||"\n"===e[t-1]&&(1===t||"\n"===e[t-2]))return"";let r=e.lastIndexOf("\n",t-1);return/\S/.test(e.substring(r,t))?"\n\n":"\n"}(r.current.value,r.current.selectionStart),i=function(e,t){if(e.length===t||"\n"===e[t]&&(t===e.length-1||"\n"===e[t+1]))return"";let r=e.indexOf("\n",t);return/\S/.test(e.substring(t,r))?"\n\n":"\n"}(r.current.value,r.current.selectionEnd);e(`${n}${t.map(eM).join("\n")}${i}`)},[r,e]),m=(t,n,i)=>{if(!r?.current)return;let l=eM(t),a=r.current.value.indexOf(l);-1!==a&&e(eD(t,n,i),[a,a+l.length])},g=(0,E.U)(({file:e,url:t},r)=>{p(e=>e&&[e[0]+1,e[1]]),m(e,t,r)}),v=(0,l.useCallback)(e=>e.map(async e=>{let t={url:null,file:e},r=null;try{t=await i?.(e)??{file:e,url:null}}catch{t={file:e,url:null}}if(t.url)try{r=await (0,eA.pF)(e)}catch{r={width:0,height:0,ppi:1},(0,e_.N7)("Failed to get image size from file",{message:"Failed to get image size from file",reactAppName:"markdown-editor"})}g(t,r)}),[i,g]),b=function(e){let t=function(e){let t=eI(e),{multi:r,acceptedFileTypes:n}=e,i=(0,l.useRef)(null),a=(0,l.useCallback)(function(){this.files&&t(this.files)},[t]);(0,l.useEffect)(function(){let e=document.createElement("input");return e.setAttribute("type","file"),e.setAttribute("multiple",r?"true":"false"),n&&e.setAttribute("accept",n.join(", ")),e.style.display="none",e.addEventListener("change",a),document.body.appendChild(e),i.current=e,()=>{i.current=null,e.removeEventListener("change",a),e.parentNode?.removeChild(e)}},[r,n,a]);let o=(0,l.useCallback)(()=>i.current?.click(),[]);return(0,l.useMemo)(()=>({onClick:o}),[o])}(e),r=function(e){let t=eI(e);return(0,l.useMemo)(()=>({onPaste:e=>{t(e.clipboardData.files)&&e.preventDefault()}}),[t])}(e),[n,i]=function(e){let t=eI(e),[r,n]=(0,l.useState)(!1),i=(0,l.useCallback)(()=>n(!1),[]),a=(0,l.useCallback)(e=>{eL(e)&&(n(!0),e.stopPropagation(),e.preventDefault())},[]),o=(0,l.useCallback)(e=>{eL(e)&&(e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy")},[]),s=(0,l.useCallback)(e=>{t(e.dataTransfer.files)&&(e.preventDefault(),n(!1))},[t]);return[r,(0,l.useMemo)(()=>({onDragEnter:a,onDragOver:o,onDragLeave:i,onDrop:s}),[s,o,i,a])]}(e);return(0,l.useMemo)(()=>({clickTargetProps:t,pasteTargetProps:r,dropTargetProps:i,isDraggedOver:n}),[t,i,n,r])}({acceptedFileTypes:a,multi:!0,onSelect:(0,l.useCallback)(async(e,t)=>{e.length>0&&(p([1,e.length]),h(e),await Promise.all(v(e)),f()),d(t)},[d,h,v,f])});return n&&(b={clickTargetProps:{onClick:eR},dropTargetProps:{onDragEnter:eR,onDragLeave:eR,onDrop:eR,onDragOver:eR},pasteTargetProps:{onPaste:eR},isDraggedOver:!1}),i?{...b,errorMessage:o,uploadProgress:c}:null},eP=/^(?:\t| ? ?)(.*)/,eH=e=>eP.exec(e)?.[1]??"",eB=e=>`  ${e}`,eO=({emitChange:e})=>({onKeyDown:(0,l.useCallback)(t=>{let r=t.currentTarget;if(t.defaultPrevented||"Tab"!==t.key||r.selectionEnd-r.selectionStart==0)return;t.preventDefault();let[n,i]=(0,eA.ty)(r),l=r.value.slice(n,i).split(/\r?\n/).map(e=>t.shiftKey?eH(e):eB(e)).join("\n");e(l,[n,i],[n,n+l.length])},[e])});var eW=r(27278),eF=r(60499);let eU={viewSwitch:"ViewSwitch-module__viewSwitch--fmIde",tabNavLink:"ViewSwitch-module__tabNavLink--AZkCL",editColor:"ViewSwitch-module__editColor--UxQhv",previewColor:"ViewSwitch-module__previewColor--aXo83"},ez=({selectedView:e,onViewSelect:t,onLoadPreview:r,disabled:i})=>{let l="preview"===e?{onClick:()=>t?.("edit")}:{onClick:()=>{r(),t?.("preview")},onMouseOver:()=>r(),onFocus:()=>r()};return(0,n.jsx)("div",{className:eU.viewSwitch,children:(0,n.jsxs)(eF.A,{"aria-label":"View mode",children:[(0,n.jsx)(eF.A.Link,{...l,as:"button",selected:"edit"===e,disabled:i,className:(0,w.$)(eU.tabNavLink,"edit"===e?eU.editColor:eU.previewColor),children:"Write"}),(0,n.jsx)(eF.A.Link,{...l,as:"button",selected:"preview"===e,disabled:i,className:(0,w.$)(eU.tabNavLink,"preview"===e?eU.editColor:eU.previewColor),children:"Preview"})]})})};try{ez.displayName||(ez.displayName="ViewSwitch")}catch{}let eV=Symbol(),eK=[],eq=(0,l.forwardRef)(({value:e,onChange:t,onInputFocus:r,disabled:i=!1,placeholder:s,maxLength:c,"aria-describedby":h,labelledBy:m,fullHeight:g,onRenderPreview:v,className:b,onPrimaryAction:x,viewMode:y,onChangeViewMode:k,minHeightLines:D=5,maxHeightLines:H=35,emojiSuggestions:B,emojiTone:O,mentionSuggestions:W,referenceSuggestions:F,onUploadFile:U,acceptedFileTypes:z,monospace:V=!1,required:K=!1,name:q,children:Q,savedReplies:G,pasteUrlsAsPlainText:X=!1,errorMessage:J,teamHovercardsEnabled:Y=!1,onSavedRepliesOpen:Z=T.l},ee)=>{let[et,er]=(0,d.H)(Q,{toolbar:eT,actions:o,label:C,footer:f}),[en,ei]=(0,l.useState)("edit"),[el,ea]=void 0===y?[en,ei]:[y,k],[eo,es]=(0,l.useState)(null),eu=(0,E.U)(es),ec=(0,l.useRef)(!0);(0,l.useEffect)(()=>{ec.current=!0},[e]);let ep=async()=>{ec.current&&(ec.current=!1,eu(null),eu(await v(e)))},ef=(0,S.G7)("mardown_editor_use_on_input");(0,l.useEffect)(()=>{"preview"===el&&ec.current&&ep()});let[eh,em]=(0,l.useState)(1),eg=()=>{t(""),em(e=>e+1)},ev=(0,l.useRef)(null);(0,l.useImperativeHandle)(ee,()=>({focus:e=>ev.current?.focus(e),scrollIntoView:e=>eI.current?.scrollIntoView(e),reset:()=>eg(),[eV]:void 0}));let ew=(0,l.useRef)(0);ev.current&&ev.current.offsetHeight&&(ew.current=ev.current.offsetHeight);let ex=(0,l.useCallback)(e=>{t(e.target.value)},[t]),ey=(0,N.H)({inputRef:ev,fallbackEventHandler:ex}),ek=e$({emitChange:ey,value:e,inputRef:ev,disabled:i,onUploadFile:U,acceptedFileTypes:z}),eC=ek?.uploadProgress!==void 0,e_=(0,eW.KI)({emitChange:ey}),eE=eO({emitChange:ey}),eN=(0,l.useRef)(null),eI=(0,l.useRef)(null),[eL,eM]=(0,l.useState)(!1),eD=(0,l.useCallback)(()=>eM(null!==eI.current&&eI.current.clientWidth<675),[]);(0,I.w)(eD,eI),(0,L.A)(()=>{let e=eI.current;if(!e)return;let t=e.parentElement,r=eI.current.nextSibling;t?.removeChild(e),t?.insertBefore(e,r)},[eL]);let eR=(0,l.useId)(),eP=`${eR}-description`,eH=(0,l.useRef)(null),eB=(0,l.useMemo)(()=>G?{savedReplies:G,onSelect:e=>{requestAnimationFrame(()=>ey(e.content))},onOpen:Z,ref:eH}:null,[ey,Z,G]),eF=(0,_._)(e=>{let t=eN.current;if(!i){if(e.ctrlKey&&"."===e.key)eH.current?.openMenu(),e.preventDefault(),e.stopPropagation();else if((0,eA.VL)(e)){if("Enter"!==e.key||eC){if("b"===e.key)t?.bold();else if("i"===e.key)t?.italic();else if(e.shiftKey&&"."===e.key)t?.quote();else if("e"===e.key)t?.code();else if("k"===e.key)t?.link();else if("8"===e.key)t?.unorderedList();else if(e.shiftKey&&"7"===e.key)t?.orderedList();else if(e.shiftKey&&["l","L"].includes(e.key))t?.taskList();else{if(!(e.shiftKey&&["p","P"].includes(e.key)))return;ea?.("preview")}}else x?.();e.preventDefault(),e.stopPropagation()}else e_.onKeyDown(e),eE.onKeyDown(e)}});(0,l.useEffect)(()=>{if("preview"===el){eK.push(eR);let e=e=>{!e.defaultPrevented&&eK.at(-1)===eR&&(0,eA.VL)(e)&&e.shiftKey&&"p"===e.key&&(ea?.("edit"),setTimeout(()=>ev.current?.focus()),e.preventDefault())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e),eK=eK.filter(e=>e!==eR)}}},[el,ea,eR]);let eU=(0,l.useMemo)(()=>({disabled:i,formattingToolsRef:eN,condensed:eL,required:K,fileDraggedOver:ek?.isDraggedOver??!1,fileUploadProgress:ek?.uploadProgress,uploadButtonProps:ek?.clickTargetProps??null,errorMessage:ek?.errorMessage,previewMode:"preview"===el}),[i,eL,K,ek?.isDraggedOver,ek?.uploadProgress,ek?.clickTargetProps,ek?.errorMessage,el]);return(0,n.jsx)(a.Provider,{value:eU,children:(0,n.jsxs)("fieldset",{"aria-disabled":i,className:(0,w.$)(P.fieldSet,g&&P.fullHeight),children:[(0,n.jsx)($,{ref:eN,forInputId:eR}),(0,n.jsx)("div",{className:P.hidden,children:er}),et.label,(0,n.jsxs)("div",{ref:eI,className:P.container,children:[(0,n.jsxs)("div",{className:(0,w.$)(b,"edit"===el?P.inputWrapper:P.previewWrapper,i&&P.disabled,g&&P.fullHeight),children:[(0,n.jsxs)("span",{className:"sr-only",id:eP,"aria-live":"polite",children:["Markdown input:","preview"===el?" preview mode selected.":" edit mode selected."]}),(0,n.jsxs)("header",{className:P.header,children:[(0,n.jsxs)("div",{className:P.viewSwitchWrapper,children:[(0,n.jsx)(ez,{selectedView:el,onViewSelect:ea,disabled:ek?.uploadProgress!==void 0,onLoadPreview:ep}),(0,n.jsx)("div",{className:P.viewSwitchBorder})]}),(0,n.jsx)(eb.Provider,{value:eB,children:"edit"===el&&(et.toolbar??(0,n.jsx)(ej,{children:(0,n.jsx)(eS,{})}))})]}),(0,n.jsx)(ed,{value:e,onChange:ef?void 0:ex,onInput:ef?ex:void 0,onFocus:r,emojiSuggestions:B,emojiTone:O,mentionSuggestions:W,referenceSuggestions:F,disabled:i,placeholder:s,labelledBy:m,"aria-describedby":h?`${eP} ${h}`:eP,id:eR,maxLength:c,ref:ev,fullHeight:g,isDraggedOver:ek?.isDraggedOver??!1,minHeightLines:D,maxHeightLines:H,visible:"edit"===el,monospace:V,required:K,name:q,pasteUrlsAsPlainText:X,...eF,...ek?.pasteTargetProps,...ek?.dropTargetProps},eh),(0,n.jsx)("div",{role:"alert",children:"edit"===el&&ek?.errorMessage&&(0,n.jsx)(R,{message:ek.errorMessage})}),"preview"===el&&(0,n.jsxs)("div",{"aria-live":"polite",tabIndex:-1,className:(0,w.$)(P.previewViewerWrapper,g&&P.fullHeight),style:{minHeight:ew.current},children:[(0,n.jsx)("h2",{className:P.previewHeader,children:"Rendered Markdown Preview"}),(0,n.jsx)(j.G,{verifiedHTML:eo||"Nothing to preview",loading:null===eo,teamHovercardsEnabled:Y,openLinksInNewTab:!0})]})]}),J&&(0,n.jsxs)(A.A,{variant:"danger",className:P.flash,children:[(0,n.jsx)(M.A,{icon:u.StopIcon,className:"mr-2"}),J]}),et.footer??(0,n.jsx)(p,{children:(0,l.isValidElement)(et.actions)&&et.actions.props.children})]})]})})});eq.displayName="MarkdownEditor";let eQ=Object.assign(eq,{Label:C,Toolbar:eT,ToolbarButton:ev,DefaultToolbarButtons:eS,Footer:f,FooterButton:h,Actions:o,ActionButton:s,MarkdownEditorContext:a})},92575:(e,t,r)=>{r.d(t,{C:()=>i});var n=r(5804);let i=(e,t,r,i,l)=>async a=>{if("loading"===e)return"loading";let o=Array.isArray(e)?e:await e(),s=a?o.map(e=>[t(a,e),e]).filter(([e])=>e>n.IP).sort(([e,t],[n,i])=>n===e?-r(i,t):n-e).slice(0,5).map(([,e])=>e):o.slice(0,5);return l&&s.sort(r),s.map(i)}},27278:(e,t,r)=>{r.d(t,{KI:()=>c,VB:()=>u,a1:()=>d});var n=r(96540),i=r(32020);let l=({leadingWhitespace:e="",delimeter:t,taskBox:r,text:n})=>{if(!n)return null;let i="number"==typeof t?`${t+1}.`:t;return`
${e}${i}${r?" [ ]":""} `},a=({leadingWhitespace:e="",delimeter:t,taskBox:r})=>{let n="number"==typeof t?`${t}.`:t;return`${n}${e}${r?" [ ]":" "}
`},o=/^(\s*(?:>\s*)*(?:[*-]\s{1,4})*)([*-]|(\d+)\.)(\s{1,4})(?:(\[[\sx]\])\s)?(.*)/i,s=e=>"number"==typeof e?.delimeter,u=e=>{let t=o.exec(e);if(!t)return null;let[,r="",n,i="",l,a=null,s]=t,u=Number.parseInt(i,10);return{leadingWhitespace:r,text:s,delimeter:Number.isNaN(u)?n:u,middleWhitespace:l,taskBox:a}},d=e=>"number"==typeof e.delimeter?`${e.leadingWhitespace}${e.delimeter}.${e.middleWhitespace}${e.taskBox?`${e.taskBox} `:""}${e.text}`:`${e.leadingWhitespace}${e.delimeter}${e.middleWhitespace}${e.taskBox||""} ${e.text}`,c=({emitChange:e})=>{let t=(0,n.useCallback)((t,r)=>{let[n,l]=r||(0,i.ty)(t),a=u(t.value.slice(n,l));if(!s(a))return;let o=t.value.slice(l+1).split(/\r?\n/),c=[],p=a.delimeter;for(let e of o){let t=u(e);if(!s(t)||t.delimeter!==p)break;c.push(t),p++}if(0===c.length)return;let f=`
${c.map(e=>d({...e,delimeter:e.delimeter+1})).join("\n")}`;e(f,[l,l+f.length+1],t.selectionStart)},[e]);return{onKeyDown:(0,n.useCallback)(r=>{if("Enter"===r.key&&!r.shiftKey&&!r.defaultPrevented){let n=r.currentTarget,[o,s]=(0,i.ty)(n),d=u(n.value.slice(o,n.selectionStart)+n.value.slice(n.selectionEnd,s));if(d){if(r.preventDefault(),n.selectionStart===o){let r=a(d);null===r?e("",[o,n.selectionEnd]):(e(r),t(n,[o,o+r.length-1]))}else{let r=l(d);null===r?e("",[o,n.selectionEnd]):(e(r),t(n))}}}},[e,t])}}},32020:(e,t,r)=>{r.d(t,{pF:()=>d,ty:()=>l,VL:()=>s,nf:()=>a,TG:()=>c,iQ:()=>o});var n=r(96884);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let PNGScanner=class PNGScanner{advance(e){this.pos+=e}readInt(e){let t=this,r=function(){switch(e){case 1:return t.dataview.getUint8(t.pos);case 2:return t.dataview.getUint16(t.pos);case 4:return t.dataview.getUint32(t.pos);default:throw Error("bytes parameter must be 1, 2 or 4")}}();return this.advance(e),r}readChar(){return this.readInt(1)}readShort(){return this.readInt(2)}readLong(){return this.readInt(4)}readString(e){let t=[];for(let r=0;r<e;r++)t.push(String.fromCharCode(this.readChar()));return t.join("")}scan(e){if(0x89504e47!==this.readLong())throw Error("invalid PNG");for(this.advance(4);;){let t=this.readLong(),r=this.readString(4),n=this.pos+t+4;if(!1===e.call(this,r,t)||"IEND"===r)break;this.pos=n}}constructor(e,t){i(this,"dataview",void 0),i(this,"pos",void 0),i(this,"callback",void 0),this.dataview=new DataView(e),this.pos=0,this.callback=t}};let l=e=>{let t=e.value.lastIndexOf("\n",e.selectionStart-1)+1,r=e.value.indexOf("\n",e.selectionEnd);return -1===r&&(r=e.value.length),[t,r]},a=e=>`<!-- ${e.replaceAll("--","\\-\\-")} -->`,o=(e,t)=>`[${e.replaceAll("[","\\[").replaceAll("]","\\]")}](${t.replaceAll("(","\\(").replaceAll(")","\\)")})`,s=e=>(0,n.U0)()?e.metaKey:e.ctrlKey,u=e=>{let t=new PNGScanner(e),r={width:0,height:0,ppi:1};return t.scan(function(e){switch(e){case"IHDR":r.width=this.readLong(),r.height=this.readLong();break;case"pHYs":{let e;let t=this.readLong(),n=this.readLong();return 1===this.readChar()&&(e=.0254),e&&(r.ppi=Math.round((t+n)/2*e)),!1}case"IDAT":return!1}return!0}),r},d=async e=>{let t=await new Promise((t,r)=>{let n=new FileReader;n.onload=()=>t(n.result),n.onerror=()=>r(n.error),n.readAsArrayBuffer(e)});return t?u(t):null},c=(e,t,r="Image")=>{if(144===e.ppi){let n=Math.round(e.width/2);return`<img width="${n}" alt="${r}" src="${t}" />`}return`![${r}](${t})`}},12800:(e,t,r)=>{r.d(t,{S:()=>l});var n=r(38568),i=r(96540);let l=({disabled:e,minHeightLines:t,maxHeightLines:r,elementRef:l,value:a})=>{let[o,s]=(0,i.useState)(void 0),[u,d]=(0,i.useState)(void 0),[c,p]=(0,i.useState)(void 0),f=(0,i.useCallback)(()=>{if(e)return;let n=l.current;if(!n)return;let i=getComputedStyle(n);s(`calc(${n.scrollHeight}px - ${i.paddingTop} - ${i.paddingBottom})`);let a="normal"===i.lineHeight?`1.2 * ${i.fontSize}`:i.lineHeight;void 0!==t&&d(`calc(${t} * ${a})`),void 0!==r&&p(`calc(${r} * ${a})`)},[t,r,a,l,e]);return(0,n.N)(f,[f]),(0,i.useEffect)(f,[]),{height:o,minHeight:u,maxHeight:c,boxSizing:"content-box"}}},55412:(e,t,r)=>{r.d(t,{O:()=>i});var n=r(96540);let i=({htmlContainerRef:e,htmlContainer:t,onLinkClick:r,openLinksInNewTab:i})=>{(0,n.useEffect)(()=>{let n=e?.current||t;if(!n)return;let l=e=>{let t=e.target.closest("a");t&&(r?.(e),!e.defaultPrevented&&i&&t.href&&(window.open(t.href,"_blank","noopener noreferrer"),e.preventDefault()))};return n.addEventListener("click",l),()=>{n?.removeEventListener("click",l)}},[t,e,r,i])}},84100:(e,t,r)=>{r.d(t,{U:()=>a,g:()=>l});var n=r(38568),i=r(96540);let l=Symbol("callbackCancelledResult"),a=(e,t=!1)=>{let r=(0,i.useRef)(e);(0,n.N)(()=>{r.current=e},[e]);let a=(0,i.useRef)(!1);return(0,i.useEffect)(()=>(a.current=!0,()=>{t||(a.current=!1)}),[t]),(0,i.useCallback)((...e)=>a.current?r.current(...e):l,[])}},80758:(e,t,r)=>{r.d(t,{H:()=>a});var n=r(96540);let i=(e,t,r)=>{let n=t[1]-t[0];return e<t[0]?e:e<t[1]?t[0]+r:e+(r-n)},l=(e,t)=>({...e,nativeEvent:e,target:t,currentTarget:t,preventDefault:()=>e.preventDefault(),isDefaultPrevented:()=>e.defaultPrevented,isPropagationStopped:()=>!1,persist:()=>({})}),a=({inputRef:e,fallbackEventHandler:t})=>(0,n.useCallback)((r,n,a)=>{let o=e.current;if(!o)return;let s=document.activeElement;o.focus();let u=n??[o.selectionStart??o.value.length,o.selectionEnd??o.value.length],d=void 0===a?i(o.selectionStart??o.value.length,u,r.length):Array.isArray(a)?a[0]:a,c=Array.isArray(a)?a[1]:d,p=!1;try{if(document.activeElement!==o)throw Error("Input must be focused to use execCommand");o.setSelectionRange(u[0],u[1]),p=""===r?document.execCommand("delete",!1):document.execCommand("insertText",!1,r),o.setSelectionRange(d,c)}catch{p=!1}if((s instanceof HTMLInputElement||s instanceof HTMLTextAreaElement)&&s.focus(),!p){let n=o.value.slice(0,u[0])+r+o.value.slice(u[1]),i=new InputEvent("input",{bubbles:!1});e.current.value=n,e.current.setSelectionRange(d,c),e.current.dispatchEvent(i),t(l(i,e.current))}},[e,t])},26514:(e,t,r)=>{r.d(t,{T:()=>f});var n=r(74848),i=r(45996),l=r(38621),a=r(87330),o=r(96540),s=r(20053),u=r(42522),d=r(13080),c=r(76797);let p={tooltip:"CopyToClipboardButton-module__tooltip--Dq1IB"};function f({icon:e=l.CopyIcon,size:t="medium",onCopy:r,textToCopy:f,tooltipProps:h,variant:m="invisible",ariaLabel:g,className:v,disabled:b,...w}){let[x,y]=o.useState(!1),k=(0,i.A)(),C=g??`Copy "${f}" to clipboard`,S=x?"Copied!":C,j={size:t,variant:m,onClick:()=>{y(!0),(0,d.i)("Copied!"),(0,c.D)(f),r?.(),setTimeout(()=>k()&&y(!1),2e3)},icon:x?l.CheckIcon:e,className:(0,s.$)(x?"color-fg-success":void 0,v),...w},T=(0,o.useId)();return b?(0,n.jsx)(a.K,{...j,"aria-label":C,disabled:!0}):(0,n.jsx)(u.m,{text:S,"aria-label":C,type:"label",id:T,"aria-hidden":!0,...h,className:(0,s.$)(p.tooltip,h?.className),children:(0,n.jsx)(a.K,{...j,"aria-labelledby":T})})}try{f.displayName||(f.displayName="CopyToClipboardButton")}catch{}},70255:(e,t,r)=>{r.d(t,{a:()=>R});var n=r(74848),i=r(70170);let l=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],a=(e,t)=>{let{height:r,top:n,left:i}=function(e,t){let r="mozInnerScreenX"in window,n=document.createElement("div");n.id="input-textarea-caret-position-mirror-div",document.body.appendChild(n);let i=n.style,a=window.getComputedStyle(e),o=isNaN(parseInt(a.lineHeight))?1.2*parseInt(a.fontSize):parseInt(a.lineHeight),s=e instanceof HTMLInputElement;for(let t of(i.whiteSpace=s?"nowrap":"pre-wrap",i.wordWrap=s?"":"break-word",i.position="absolute",l))if(s&&"lineHeight"===t){if("border-box"===a.boxSizing){let e=parseInt(a.height),t=parseInt(a.paddingTop)+parseInt(a.paddingBottom)+parseInt(a.borderTopWidth)+parseInt(a.borderBottomWidth),r=t+o;e>r?i.lineHeight=`${e-t}px`:e===r?i.lineHeight=a.lineHeight:i.lineHeight="0"}else i.lineHeight=a.height}else if(s||"width"!==t||"border-box"!==a.boxSizing)i[t]=a[t];else{let t=parseFloat(a.borderLeftWidth)+parseFloat(a.borderRightWidth),n=r?parseFloat(a.width)-t:e.clientWidth+t;i.width=`${n}px`}r?e.scrollHeight>parseInt(a.height)&&(i.overflowY="scroll"):i.overflow="hidden",n.textContent=e.value.substring(0,t),s&&(n.textContent=n.textContent.replace(/\s/g,"\xa0"));let u=document.createElement("span");u.textContent=s?".":e.value.substring(t)||".",n.appendChild(u);let d={top:u.offsetTop+parseInt(a.borderTopWidth),left:u.offsetLeft+parseInt(a.borderLeftWidth),height:o};return document.body.removeChild(n),d}(e,t);return{height:r,top:n-e.scrollTop,left:i-e.scrollLeft}},o=(e,t)=>{let{top:r,left:n,height:i}=a(e,t),{top:l,left:o}=e.getBoundingClientRect();return{height:i,top:l+r,left:o+n}};var s=r(47584),u=r(80758),d=r(74021),c=r(64515),p=r(16255),f=r(20053),h=r(96540),m=r(35908),g=r(38568);let v=({isOpen:e,listElement:t,inputElement:r,onCommit:n,options:i,tabInsertsSuggestions:l=!1,firstOptionSelectionMode:a="none"})=>{let o=(0,h.useId)(),s=`combobox-${o}__option`,u=(0,h.useRef)(e),[d,c]=(0,h.useState)(null),p=(0,h.useCallback)(()=>[...t?.querySelectorAll("[role=option]")??[]],[t]),f=(0,h.useCallback)(e=>{let t=e.target.getAttribute("data-combobox-list-index"),r=i[null!==t?parseInt(t,10):NaN];r&&n({nativeEvent:e,option:r})},[i,n]),v=(0,h.useCallback)(e=>e.preventDefault(),[]);(0,h.useEffect)(function(){if(r&&t){t.getAttribute("role")||t.setAttribute("role","listbox");let e=new m.A(r,t,{tabInsertsSuggestions:l,firstOptionSelectionMode:a});return c(e),()=>{e.destroy(),c(null)}}},[r,t,l,a]),(0,h.useEffect)(function(){let t=u.current;u.current=e&&null!==d,e!==t&&d&&(e?d.start():d.stop())},[e,d]),(0,h.useEffect)(function(){return t?.addEventListener("combobox-commit",f),()=>t?.removeEventListener("combobox-commit",f)},[f,t]),(0,g.N)(()=>{let e=p();for(let[t,r]of e.entries())(!r.id||r.id.startsWith(s))&&(r.id=`${s}-${t}`),r.setAttribute("data-combobox-list-index",t.toString()),r.addEventListener("mousedown",v);return d?.resetSelection(),()=>{for(let t of e)t.removeEventListener("mousedown",v)}},[p,s,i,d,v])};var b=r(63867),w=r(8338),x=r(45221),y=r(72751);let k={Box_0:"AutocompleteSuggestions-module__Box_0--iBnIs",Overlay_0:"AutocompleteSuggestions-module__Overlay_0--QuLJW",ActionListItem:"AutocompleteSuggestions-module__ActionListItem--jPkc1"},C=new Set([" ","\n"]),S=new Set([".","\n"]),j=(e,t,r)=>{let n=e.sort((e,t)=>t.triggerChar.length-e.triggerChar.length);for(let e=r-1,i="",l=n;e>=0&&l.length>0;e--){let r=t[e]??"";for(let n of(i=r+i,C.has(r)&&(l=l.filter(e=>e.multiWord)),S.has(r)&&(l=l.filter(e=>!e.multiWord)),l.filter(e=>i.startsWith(e.triggerChar)))){let r=t[e-1]??"",a=i[1]??"";if((!r||/[\s([]/.test(r))&&(!a||!/\s/.test(a)))return{trigger:n,query:i.slice(n.triggerChar.length)};l=l.filter(e=>e!==n)}}return null},T=e=>"string"==typeof e?e:e.value,_=e=>"string"==typeof e?e:e.key??e.value,E=(...e)=>t=>{for(let r of[...e].reverse())t.isDefaultPrevented()||r?.(t)},N=()=>(0,n.jsx)("div",{className:k.Box_0,children:(0,n.jsx)(b.A,{size:"small"})}),I=({suggestion:e})=>{let t=T(e),r={id:t,children:t,role:"option",className:k.ActionListItem};return"string"==typeof e?(0,n.jsx)(w.l.Item,{...r}):e.render(r)},L=({suggestions:e,portalName:t,triggerCharCoords:r,onClose:i,onCommit:l,inputRef:a,visible:o,tabInsertsSuggestions:s,defaultPlacement:u,firstOptionSelectionMode:d="active"})=>{let c=(0,h.useRef)(null),[p,f]=(0,h.useState)(null),m=(0,h.useCallback)(({option:e})=>{l(T(e))},[l]);v({isOpen:o&&"loading"!==e,listElement:p,inputElement:a.current,onCommit:m,options:Array.isArray(e)?e:[],tabInsertsSuggestions:s,firstOptionSelectionMode:d});let[g,b]=(0,h.useState)(0);return(0,x.A)(function(){let e=c.current?.offsetHeight??0,t=r.top+r.height,n=t+e>window.innerHeight,i=r.top-e,l=i<0,a={below:n&&!l?i:t,above:l&&!n?t:i}[u];b(Number.isNaN(a)?0:a)},[r.top,r.height,e,o,u]),o?(0,n.jsx)(y.Ay,{onEscape:i,onClickOutside:i,returnFocusRef:a,preventFocusOnOpen:!0,portalContainerName:t,top:g,left:r.left,ref:c,className:k.Overlay_0,children:(0,n.jsx)(w.l,{ref:f,role:"listbox",children:"loading"===e?(0,n.jsx)(N,{}):e?.map(e=>n.jsx(I,{suggestion:e},_(e)))})}):(0,n.jsx)(n.Fragment,{})};L.displayName="SuggestionList";try{N.displayName||(N.displayName="LoadingIndicator")}catch{}try{I.displayName||(I.displayName="SuggestionListItem")}catch{}let A={container:"InlineAutocomplete-module__container--UwGMb",fullWidth:"InlineAutocomplete-module__fullWidth--X6eXo"},M=e=>{try{return e.selectionStart}catch(e){if(e instanceof TypeError)return null;throw e}},D=()=>{},R=({triggers:e,suggestions:t,onShowSuggestions:r,onHideSuggestions:l,onSelectSuggestion:a,style:m,children:g,tabInsertsSuggestions:v=!1,suggestionsPlacement:b="below",firstOptionSelectionMode:w="active",portalName:x,fullWidth:y=!1,...k})=>{let[,C]=(0,h.useState)(0),S=(0,d.Lf)(k),_=(0,h.useRef)(null);(0,c.T)(g.ref??D,_);let N=function(e,t){if(h.Children.only(e),t.current&&!(t.current instanceof HTMLInputElement)&&!(t.current instanceof HTMLTextAreaElement))throw TypeError("AutocompleteTextarea child must be a component that forwards a ref and props to an <input> or <textarea> element.");return e}(g,_),I=(0,u.H)({inputRef:_,fallbackEventHandler:N.props.onChange??D}),R=(0,h.useRef)(null),$=null!==t&&t.length>0;(0,h.useEffect)(()=>{if($){let e=(0,i.n)(()=>C(e=>e+1),100);return document.addEventListener("scroll",e,{capture:!0}),()=>{document.removeEventListener("scroll",e,{capture:!0})}}},[$]);let P=_.current&&R.current&&$?o(_.current,(M(_.current)??0)-R.current.query.length):{top:0,left:0,height:0},H=(0,h.cloneElement)(N,{...S,onBlur:E(N.props.onBlur,()=>{l()}),onKeyDown:E(N.props.onKeyDown,e=>{$&&("Escape"===e.key||"Tab"===e.key&&!v)&&(l(),e.stopPropagation())}),onChange:E(N.props.onChange,t=>{let n=M(t.currentTarget);if(null===n){l();return}R.current=j(e,t.currentTarget.value,n),R.current?r(R.current):l()}),ref:_}),B=$?"loading"===t?"Loading autocomplete suggestions\u2026":`${t.length} autocomplete ${1===t.length?"suggestion":"suggestions"} available; "${T(t[0])}" is highlighted. Press ${v?"Enter or Tab":"Enter"} to insert.`:"";return(0,n.jsxs)("div",{className:(0,f.$)(A.container,y&&A.fullWidth),style:m,children:[H,s.KJ&&(0,n.jsx)(L,{suggestions:t,inputRef:_,onCommit:e=>{if(!_.current||!R.current)return;let{query:t,trigger:r}=R.current;a?.({suggestion:e,trigger:r,query:t});let n=M(_.current)??0,i=t.length+r.triggerChar.length,o=n-i,s=r.keepTriggerCharOnCommit??!0?r.triggerChar:"",u=r.insertSpaceOnCommit??!0,d=`${s}${e}${u?" ":""}`;l(),I(d,[o,o+i])},onClose:l,triggerCharCoords:P,visible:$,tabInsertsSuggestions:v,defaultPlacement:b,firstOptionSelectionMode:w,portalName:x}),s.KJ&&(0,n.jsx)(p.Z,{children:(0,n.jsx)("span",{"aria-live":"assertive","aria-atomic":!0,style:{clipPath:"circle(0)",position:"absolute"},children:B})})]})};try{R.displayName||(R.displayName="InlineAutocomplete")}catch{}},83876:(e,t,r)=>{r.d(t,{x:()=>v});var n=r(74848),i=r(90204),l=r(5804),a=r(8338),o=r(96540),s=r(92575);function u(e){return"character"in e}let d=new Set(["+1","thumbsup","-1"]),c={triggerChar:":",keepTriggerCharOnCommit:!1},p=(e,t)=>void 0!==t?(0,n.jsx)("g-emoji",{alias:e.name,tone:t,"fallback-src":e.url,children:e.character}):e.character,f=(e,t)=>u(e)?void 0!==t?(0,i.R3)(e.character,t):e.character:`:${e.name}:`,h=e=>t=>({value:f(t,e),key:t.name,render:r=>(0,n.jsxs)(a.l.Item,{...r,children:[(0,n.jsx)(a.l.LeadingVisual,{children:u(t)?p(t,e):(0,n.jsx)("img",{src:t.url,alt:`${t.name} emoji`,height:"16",width:"16"})}),t.name]})}),m=(e,t)=>{let r=t.name.toLowerCase(),n=e.toLowerCase(),i=0;return r.includes(n)&&(i+=5,r.startsWith(n)&&(i+=5)),0===i?l.IP:i},g=(e,t)=>{let r=e.name.toLowerCase(),n=t.name.toLowerCase();return d.has(r)&&!d.has(n)?-1:d.has(n)&&!d.has(r)?1:0},v=(e,t)=>({calculateSuggestions:(0,o.useMemo)(()=>(0,s.C)(e,m,g,h(t?.tone),!0),[e,t?.tone]),trigger:c});try{d.displayName||(d.displayName="PRIORITIZED_EMOJIS")}catch{}},83476:(e,t,r)=>{r.d(t,{G:()=>b});var n=r(74848),i=r(96540),l=r(64515),a=r(75177),o=r(63867),s=r(44968),u=r(55412),d=r(27278),c=r(45221);let p=e=>{let t=e.match(/^ {0,3}(`{3,}|~{3,})[^`]*$/);return t?t[1]:null},f=(e,t)=>RegExp(`^ {0,3}${t}${t[0]}* *$`).test(e),h=e=>"string"==typeof e?.taskBox,m=e=>({...e,taskBox:"[ ]"===e.taskBox?"[x]":"[ ]"}),g=({htmlContainer:e,markdownValue:t,onChange:r,disabled:n=!1,dependencies:l=[]})=>{let a=(0,i.useRef)(t);(0,c.A)(()=>{a.current=t},[t]);let o=(0,i.useCallback)(e=>()=>{let t=a.current.split(/\r?\n/),n=null;for(let i=0,l=0;i<t.length;i++){let o=t[i];if(n){if(f(o,n)){n=null;continue}}else n=p(o);if(n)continue;let s=(0,d.VB)(o);if(h(s)){if(l===e){let e=(0,d.a1)(m(s));t.splice(i,1,e);let n=t.join("\n");a.current=n,r(n);return}l++}}},[r]),[s,u]=(0,i.useState)([]);(0,i.useEffect)(()=>{u(Array.from(e?.querySelectorAll("input[type=checkbox].task-list-item-checkbox")??[]))},[e,...l]),(0,i.useEffect)(function(){let e=s.map(e=>{let t=e.disabled;return e.disabled=n,()=>{e.disabled=t}});return()=>{for(let t of e)t()}},[s,n]),(0,i.useEffect)(function(){let e=new AbortController;for(let[t,r]of s.entries()){let n=o(t);r.addEventListener("change",n,{signal:e.signal})}return()=>{e.abort()}},[s,o])};var v=r(20053);let b=(0,i.forwardRef)(function({verifiedHTML:e,loading:t=!1,markdownValue:r="",onChange:d,disabled:c=!1,onLinkClick:p,openLinksInNewTab:f=!1,teamHovercardsEnabled:h=!1,className:m},b){let[w,x]=(0,i.useState)(null),y=(0,i.useRef)(null);(0,l.T)(b,y);let k=(0,i.useCallback)(e=>{y.current=e,x(e)},[]);return g({onChange:(0,i.useCallback)(async t=>{try{await d?.(t)}catch{w&&(w.innerHTML=e)}},[d,w,e]),disabled:c||!d,htmlContainer:w??void 0,markdownValue:r,dependencies:[e]}),(0,u.O)({htmlContainer:w??void 0,onLinkClick:p,openLinksInNewTab:f}),(0,i.useMemo)(()=>t?(0,n.jsx)(a.A,{sx:{display:"flex",justifyContent:"space-around",p:2},children:(0,n.jsx)(o.A,{"aria-label":"Loading content..."})}):(0,n.jsx)(s.oG,{ref:k,className:(0,v.$)("markdown-body",m),sx:m?{}:{fontSize:1,maxWidth:"100%","& > div > :last-child":{mb:0}},html:e,...h?{"data-team-hovercards-enabled":!0}:{}}),[m,t,h,e,k])});try{b.displayName||(b.displayName="MarkdownViewer")}catch{}}}]);
//# sourceMappingURL=ui_packages_comment-box_api_file-upload_ts-ui_packages_comment-box_api_preview_ts-ui_packages-2c5e84-b159f0b6625e.js.map